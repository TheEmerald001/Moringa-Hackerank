{"ast":null,"code":"import $8NyvN$babelruntimehelpersesmextends from \"@babel/runtime/helpers/esm/extends\";\nimport { forwardRef as $8NyvN$forwardRef, useState as $8NyvN$useState, createElement as $8NyvN$createElement, useEffect as $8NyvN$useEffect } from \"react\";\nimport { createContextScope as $8NyvN$createContextScope } from \"@radix-ui/react-context\";\nimport { useCallbackRef as $8NyvN$useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { useLayoutEffect as $8NyvN$useLayoutEffect } from \"@radix-ui/react-use-layout-effect\";\nimport { Primitive as $8NyvN$Primitive } from \"@radix-ui/react-primitive\";\n/* -------------------------------------------------------------------------------------------------\n * Avatar\n * -----------------------------------------------------------------------------------------------*/\n\nconst $cddcb0b647441e34$var$AVATAR_NAME = 'Avatar';\nconst [$cddcb0b647441e34$var$createAvatarContext, $cddcb0b647441e34$export$90370d16b488820f] = $8NyvN$createContextScope($cddcb0b647441e34$var$AVATAR_NAME);\nconst [$cddcb0b647441e34$var$AvatarProvider, $cddcb0b647441e34$var$useAvatarContext] = $cddcb0b647441e34$var$createAvatarContext($cddcb0b647441e34$var$AVATAR_NAME);\nconst $cddcb0b647441e34$export$e2255cf6045e8d47 = /*#__PURE__*/$8NyvN$forwardRef((props, forwardedRef) => {\n  const {\n    __scopeAvatar: __scopeAvatar,\n    ...avatarProps\n  } = props;\n  const [imageLoadingStatus, setImageLoadingStatus] = $8NyvN$useState('idle');\n  return /*#__PURE__*/$8NyvN$createElement($cddcb0b647441e34$var$AvatarProvider, {\n    scope: __scopeAvatar,\n    imageLoadingStatus: imageLoadingStatus,\n    onImageLoadingStatusChange: setImageLoadingStatus\n  }, /*#__PURE__*/$8NyvN$createElement($8NyvN$Primitive.span, $8NyvN$babelruntimehelpersesmextends({}, avatarProps, {\n    ref: forwardedRef\n  })));\n});\n/*#__PURE__*/\n\nObject.assign($cddcb0b647441e34$export$e2255cf6045e8d47, {\n  displayName: $cddcb0b647441e34$var$AVATAR_NAME\n});\n/* -------------------------------------------------------------------------------------------------\n * AvatarImage\n * -----------------------------------------------------------------------------------------------*/\n\nconst $cddcb0b647441e34$var$IMAGE_NAME = 'AvatarImage';\nconst $cddcb0b647441e34$export$2cd8ae1985206fe8 = /*#__PURE__*/$8NyvN$forwardRef((props, forwardedRef) => {\n  const {\n    __scopeAvatar: __scopeAvatar,\n    src: src,\n    onLoadingStatusChange = () => {},\n    ...imageProps\n  } = props;\n  const context = $cddcb0b647441e34$var$useAvatarContext($cddcb0b647441e34$var$IMAGE_NAME, __scopeAvatar);\n  const imageLoadingStatus = $cddcb0b647441e34$var$useImageLoadingStatus(src);\n  const handleLoadingStatusChange = $8NyvN$useCallbackRef(status => {\n    onLoadingStatusChange(status);\n    context.onImageLoadingStatusChange(status);\n  });\n  $8NyvN$useLayoutEffect(() => {\n    if (imageLoadingStatus !== 'idle') handleLoadingStatusChange(imageLoadingStatus);\n  }, [imageLoadingStatus, handleLoadingStatusChange]);\n  return imageLoadingStatus === 'loaded' ? /*#__PURE__*/$8NyvN$createElement($8NyvN$Primitive.img, $8NyvN$babelruntimehelpersesmextends({}, imageProps, {\n    ref: forwardedRef,\n    src: src\n  })) : null;\n});\n/*#__PURE__*/\n\nObject.assign($cddcb0b647441e34$export$2cd8ae1985206fe8, {\n  displayName: $cddcb0b647441e34$var$IMAGE_NAME\n});\n/* -------------------------------------------------------------------------------------------------\n * AvatarFallback\n * -----------------------------------------------------------------------------------------------*/\n\nconst $cddcb0b647441e34$var$FALLBACK_NAME = 'AvatarFallback';\nconst $cddcb0b647441e34$export$69fffb6a9571fbfe = /*#__PURE__*/$8NyvN$forwardRef((props, forwardedRef) => {\n  const {\n    __scopeAvatar: __scopeAvatar,\n    delayMs: delayMs,\n    ...fallbackProps\n  } = props;\n  const context = $cddcb0b647441e34$var$useAvatarContext($cddcb0b647441e34$var$FALLBACK_NAME, __scopeAvatar);\n  const [canRender, setCanRender] = $8NyvN$useState(delayMs === undefined);\n  $8NyvN$useEffect(() => {\n    if (delayMs !== undefined) {\n      const timerId = window.setTimeout(() => setCanRender(true), delayMs);\n      return () => window.clearTimeout(timerId);\n    }\n  }, [delayMs]);\n  return canRender && context.imageLoadingStatus !== 'loaded' ? /*#__PURE__*/$8NyvN$createElement($8NyvN$Primitive.span, $8NyvN$babelruntimehelpersesmextends({}, fallbackProps, {\n    ref: forwardedRef\n  })) : null;\n});\n/*#__PURE__*/\n\nObject.assign($cddcb0b647441e34$export$69fffb6a9571fbfe, {\n  displayName: $cddcb0b647441e34$var$FALLBACK_NAME\n});\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction $cddcb0b647441e34$var$useImageLoadingStatus(src) {\n  const [loadingStatus, setLoadingStatus] = $8NyvN$useState('idle');\n  $8NyvN$useEffect(() => {\n    if (!src) {\n      setLoadingStatus('error');\n      return;\n    }\n\n    let isMounted = true;\n    const image = new window.Image();\n\n    const updateStatus = status => () => {\n      if (!isMounted) return;\n      setLoadingStatus(status);\n    };\n\n    setLoadingStatus('loading');\n    image.onload = updateStatus('loaded');\n    image.onerror = updateStatus('error');\n    image.src = src;\n    return () => {\n      isMounted = false;\n    };\n  }, [src]);\n  return loadingStatus;\n}\n\nconst $cddcb0b647441e34$export$be92b6f5f03c0fe9 = $cddcb0b647441e34$export$e2255cf6045e8d47;\nconst $cddcb0b647441e34$export$3e431a229df88919 = $cddcb0b647441e34$export$2cd8ae1985206fe8;\nconst $cddcb0b647441e34$export$fb8d7f40caaeea67 = $cddcb0b647441e34$export$69fffb6a9571fbfe;\nexport { $cddcb0b647441e34$export$90370d16b488820f as createAvatarScope, $cddcb0b647441e34$export$e2255cf6045e8d47 as Avatar, $cddcb0b647441e34$export$2cd8ae1985206fe8 as AvatarImage, $cddcb0b647441e34$export$69fffb6a9571fbfe as AvatarFallback, $cddcb0b647441e34$export$be92b6f5f03c0fe9 as Root, $cddcb0b647441e34$export$3e431a229df88919 as Image, $cddcb0b647441e34$export$fb8d7f40caaeea67 as Fallback };","map":{"version":3,"sources":["packages/react/avatar/src/Avatar.tsx"],"names":["AVATAR_NAME","createContextScope","createAvatarContext","Avatar","React","IMAGE_NAME","AvatarImage","onLoadingStatusChange","context","useAvatarContext","imageLoadingStatus","useImageLoadingStatus","handleLoadingStatusChange","useCallbackRef","status","useLayoutEffect","FALLBACK_NAME","AvatarFallback","delayMs","timerId","setCanRender","window","setLoadingStatus","isMounted","image","updateStatus","Root","Image","Fallback"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { useLayoutEffect } from '@radix-ui/react-use-layout-effect';\nimport { Primitive } from '@radix-ui/react-primitive';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\n/* -------------------------------------------------------------------------------------------------\n * Avatar\n * -----------------------------------------------------------------------------------------------*/\n\nconst AVATAR_NAME = 'Avatar';\n\ntype ScopedProps<P> = P & { __scopeAvatar?: Scope };\nconst [createAvatarContext, createAvatarScope] = createContextScope(AVATAR_NAME);\n\ntype ImageLoadingStatus = 'idle' | 'loading' | 'loaded' | 'error';\n\ntype AvatarContextValue = {\n  imageLoadingStatus: ImageLoadingStatus;\n  onImageLoadingStatusChange(status: ImageLoadingStatus): void;\n};\n\nconst [AvatarProvider, useAvatarContext] = createAvatarContext<AvatarContextValue>(AVATAR_NAME);\n\ntype AvatarElement = React.ElementRef<typeof Primitive.span>;\ntype PrimitiveSpanProps = Radix.ComponentPropsWithoutRef<typeof Primitive.span>;\ninterface AvatarProps extends PrimitiveSpanProps {}\n\nconst Avatar = React.forwardRef<AvatarElement, AvatarProps>(\n  (props: ScopedProps<AvatarProps>, forwardedRef) => {\n    const { __scopeAvatar, ...avatarProps } = props;\n    const [imageLoadingStatus, setImageLoadingStatus] = React.useState<ImageLoadingStatus>('idle');\n    return (\n      <AvatarProvider\n        scope={__scopeAvatar}\n        imageLoadingStatus={imageLoadingStatus}\n        onImageLoadingStatusChange={setImageLoadingStatus}\n      >\n        <Primitive.span {...avatarProps} ref={forwardedRef} />\n      </AvatarProvider>\n    );\n  }\n);\n\nAvatar.displayName = AVATAR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * AvatarImage\n * -----------------------------------------------------------------------------------------------*/\n\nconst IMAGE_NAME = 'AvatarImage';\n\ntype AvatarImageElement = React.ElementRef<typeof Primitive.img>;\ntype PrimitiveImageProps = Radix.ComponentPropsWithoutRef<typeof Primitive.img>;\ninterface AvatarImageProps extends PrimitiveImageProps {\n  onLoadingStatusChange?: (status: ImageLoadingStatus) => void;\n}\n\nconst AvatarImage = React.forwardRef<AvatarImageElement, AvatarImageProps>(\n  (props: ScopedProps<AvatarImageProps>, forwardedRef) => {\n    const { __scopeAvatar, src, onLoadingStatusChange = () => {}, ...imageProps } = props;\n    const context = useAvatarContext(IMAGE_NAME, __scopeAvatar);\n    const imageLoadingStatus = useImageLoadingStatus(src);\n    const handleLoadingStatusChange = useCallbackRef((status: ImageLoadingStatus) => {\n      onLoadingStatusChange(status);\n      context.onImageLoadingStatusChange(status);\n    });\n\n    useLayoutEffect(() => {\n      if (imageLoadingStatus !== 'idle') {\n        handleLoadingStatusChange(imageLoadingStatus);\n      }\n    }, [imageLoadingStatus, handleLoadingStatusChange]);\n\n    return imageLoadingStatus === 'loaded' ? (\n      <Primitive.img {...imageProps} ref={forwardedRef} src={src} />\n    ) : null;\n  }\n);\n\nAvatarImage.displayName = IMAGE_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * AvatarFallback\n * -----------------------------------------------------------------------------------------------*/\n\nconst FALLBACK_NAME = 'AvatarFallback';\n\ntype AvatarFallbackElement = React.ElementRef<typeof Primitive.span>;\ninterface AvatarFallbackProps extends PrimitiveSpanProps {\n  delayMs?: number;\n}\n\nconst AvatarFallback = React.forwardRef<AvatarFallbackElement, AvatarFallbackProps>(\n  (props: ScopedProps<AvatarFallbackProps>, forwardedRef) => {\n    const { __scopeAvatar, delayMs, ...fallbackProps } = props;\n    const context = useAvatarContext(FALLBACK_NAME, __scopeAvatar);\n    const [canRender, setCanRender] = React.useState(delayMs === undefined);\n\n    React.useEffect(() => {\n      if (delayMs !== undefined) {\n        const timerId = window.setTimeout(() => setCanRender(true), delayMs);\n        return () => window.clearTimeout(timerId);\n      }\n    }, [delayMs]);\n\n    return canRender && context.imageLoadingStatus !== 'loaded' ? (\n      <Primitive.span {...fallbackProps} ref={forwardedRef} />\n    ) : null;\n  }\n);\n\nAvatarFallback.displayName = FALLBACK_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction useImageLoadingStatus(src?: string) {\n  const [loadingStatus, setLoadingStatus] = React.useState<ImageLoadingStatus>('idle');\n\n  React.useEffect(() => {\n    if (!src) {\n      setLoadingStatus('error');\n      return;\n    }\n\n    let isMounted = true;\n    const image = new window.Image();\n\n    const updateStatus = (status: ImageLoadingStatus) => () => {\n      if (!isMounted) return;\n      setLoadingStatus(status);\n    };\n\n    setLoadingStatus('loading');\n    image.onload = updateStatus('loaded');\n    image.onerror = updateStatus('error');\n    image.src = src;\n\n    return () => {\n      isMounted = false;\n    };\n  }, [src]);\n\n  return loadingStatus;\n}\nconst Root = Avatar;\nconst Image = AvatarImage;\nconst Fallback = AvatarFallback;\n\nexport {\n  createAvatarScope,\n  //\n  Avatar,\n  AvatarImage,\n  AvatarFallback,\n  //\n  Root,\n  Image,\n  Fallback,\n};\nexport type { AvatarProps, AvatarImageProps, AvatarFallbackProps };\n"]},"metadata":{},"sourceType":"module"}