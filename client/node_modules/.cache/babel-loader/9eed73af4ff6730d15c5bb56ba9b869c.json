{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\nimport { useGridCellEditing } from './useGridCellEditing.new';\nimport { GridCellModes, GridEditModes } from '../../../models/gridEditRowModel';\nimport { useGridRowEditing } from './useGridRowEditing.new';\nimport { gridEditRowsStateSelector } from './gridEditRowsSelector';\nexport const editingStateInitializer = state => _extends({}, state, {\n  editRows: {}\n});\nexport const useGridEditing = (apiRef, props) => {\n  useGridCellEditing(apiRef, props);\n  useGridRowEditing(apiRef, props);\n  const debounceMap = React.useRef({});\n  const {\n    isCellEditable: isCellEditableProp\n  } = props;\n  const isCellEditable = React.useCallback(params => {\n    if (params.rowNode.isAutoGenerated) {\n      return false;\n    }\n\n    if (!params.colDef.editable) {\n      return false;\n    }\n\n    if (!params.colDef.renderEditCell) {\n      return false;\n    }\n\n    if (isCellEditableProp) {\n      return isCellEditableProp(params);\n    }\n\n    if (params.rowNode.isPinned) {\n      return false;\n    }\n\n    return true;\n  }, [isCellEditableProp]);\n\n  const maybeDebounce = (id, field, debounceMs, callback) => {\n    if (!debounceMs) {\n      callback();\n      return;\n    }\n\n    if (!debounceMap.current[id]) {\n      debounceMap.current[id] = {};\n    }\n\n    if (debounceMap.current[id][field]) {\n      const [timeout] = debounceMap.current[id][field];\n      clearTimeout(timeout);\n    } // To run the callback immediatelly without waiting the timeout\n\n\n    const runImmediately = () => {\n      const [timeout] = debounceMap.current[id][field];\n      clearTimeout(timeout);\n      callback();\n      delete debounceMap.current[id][field];\n    };\n\n    const timeout = setTimeout(() => {\n      callback();\n      delete debounceMap.current[id][field];\n    }, debounceMs);\n    debounceMap.current[id][field] = [timeout, runImmediately];\n  };\n\n  React.useEffect(() => {\n    const debounces = debounceMap.current;\n    return () => {\n      Object.entries(debounces).forEach(([id, fields]) => {\n        Object.keys(fields).forEach(field => {\n          const [timeout] = debounces[id][field];\n          clearTimeout(timeout);\n          delete debounces[id][field];\n        });\n      });\n    };\n  }, []);\n  const runPendingEditCellValueMutation = React.useCallback((id, field) => {\n    if (!debounceMap.current[id]) {\n      return;\n    }\n\n    if (!field) {\n      Object.keys(debounceMap.current[id]).forEach(debouncedField => {\n        const [, runCallback] = debounceMap.current[id][debouncedField];\n        runCallback();\n      });\n    } else if (debounceMap.current[id][field]) {\n      const [, runCallback] = debounceMap.current[id][field];\n      runCallback();\n    }\n  }, []);\n  const setEditCellValue = React.useCallback(params => {\n    const {\n      id,\n      field,\n      debounceMs\n    } = params;\n    return new Promise(resolve => {\n      maybeDebounce(id, field, debounceMs, async () => {\n        const setEditCellValueToCall = props.editMode === GridEditModes.Row ? apiRef.current.unstable_setRowEditingEditCellValue : apiRef.current.unstable_setCellEditingEditCellValue; // Check if the cell is in edit mode\n        // By the time this callback runs the user may have cancelled the editing\n\n        if (apiRef.current.getCellMode(id, field) === GridCellModes.Edit) {\n          const result = await setEditCellValueToCall(params);\n          resolve(result);\n        }\n      });\n    });\n  }, [apiRef, props.editMode]);\n  const getRowWithUpdatedValues = React.useCallback((id, field) => {\n    return props.editMode === GridEditModes.Cell ? apiRef.current.unstable_getRowWithUpdatedValuesFromCellEditing(id, field) : apiRef.current.unstable_getRowWithUpdatedValuesFromRowEditing(id);\n  }, [apiRef, props.editMode]);\n  const getEditCellMeta = React.useCallback((id, field) => {\n    const editingState = gridEditRowsStateSelector(apiRef.current.state);\n    return {\n      changeReason: editingState[id][field].changeReason\n    };\n  }, [apiRef]);\n  const editingSharedApi = {\n    isCellEditable,\n    setEditCellValue,\n    unstable_runPendingEditCellValueMutation: runPendingEditCellValueMutation,\n    unstable_getRowWithUpdatedValues: getRowWithUpdatedValues,\n    unstable_getEditCellMeta: getEditCellMeta\n  };\n  useGridApiMethod(apiRef, editingSharedApi, 'EditingApi');\n};","map":{"version":3,"sources":["/home/shaki/phase-5-project/Moringa-Hackerank1/Moringa-Hackerank/client/node_modules/@mui/x-data-grid/hooks/features/editRows/useGridEditing.new.js"],"names":["_extends","React","useGridApiMethod","useGridCellEditing","GridCellModes","GridEditModes","useGridRowEditing","gridEditRowsStateSelector","editingStateInitializer","state","editRows","useGridEditing","apiRef","props","debounceMap","useRef","isCellEditable","isCellEditableProp","useCallback","params","rowNode","isAutoGenerated","colDef","editable","renderEditCell","isPinned","maybeDebounce","id","field","debounceMs","callback","current","timeout","clearTimeout","runImmediately","setTimeout","useEffect","debounces","Object","entries","forEach","fields","keys","runPendingEditCellValueMutation","debouncedField","runCallback","setEditCellValue","Promise","resolve","setEditCellValueToCall","editMode","Row","unstable_setRowEditingEditCellValue","unstable_setCellEditingEditCellValue","getCellMode","Edit","result","getRowWithUpdatedValues","Cell","unstable_getRowWithUpdatedValuesFromCellEditing","unstable_getRowWithUpdatedValuesFromRowEditing","getEditCellMeta","editingState","changeReason","editingSharedApi","unstable_runPendingEditCellValueMutation","unstable_getRowWithUpdatedValues","unstable_getEditCellMeta"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\nimport { useGridCellEditing } from './useGridCellEditing.new';\nimport { GridCellModes, GridEditModes } from '../../../models/gridEditRowModel';\nimport { useGridRowEditing } from './useGridRowEditing.new';\nimport { gridEditRowsStateSelector } from './gridEditRowsSelector';\nexport const editingStateInitializer = state => _extends({}, state, {\n  editRows: {}\n});\nexport const useGridEditing = (apiRef, props) => {\n  useGridCellEditing(apiRef, props);\n  useGridRowEditing(apiRef, props);\n  const debounceMap = React.useRef({});\n  const {\n    isCellEditable: isCellEditableProp\n  } = props;\n  const isCellEditable = React.useCallback(params => {\n    if (params.rowNode.isAutoGenerated) {\n      return false;\n    }\n\n    if (!params.colDef.editable) {\n      return false;\n    }\n\n    if (!params.colDef.renderEditCell) {\n      return false;\n    }\n\n    if (isCellEditableProp) {\n      return isCellEditableProp(params);\n    }\n\n    if (params.rowNode.isPinned) {\n      return false;\n    }\n\n    return true;\n  }, [isCellEditableProp]);\n\n  const maybeDebounce = (id, field, debounceMs, callback) => {\n    if (!debounceMs) {\n      callback();\n      return;\n    }\n\n    if (!debounceMap.current[id]) {\n      debounceMap.current[id] = {};\n    }\n\n    if (debounceMap.current[id][field]) {\n      const [timeout] = debounceMap.current[id][field];\n      clearTimeout(timeout);\n    } // To run the callback immediatelly without waiting the timeout\n\n\n    const runImmediately = () => {\n      const [timeout] = debounceMap.current[id][field];\n      clearTimeout(timeout);\n      callback();\n      delete debounceMap.current[id][field];\n    };\n\n    const timeout = setTimeout(() => {\n      callback();\n      delete debounceMap.current[id][field];\n    }, debounceMs);\n    debounceMap.current[id][field] = [timeout, runImmediately];\n  };\n\n  React.useEffect(() => {\n    const debounces = debounceMap.current;\n    return () => {\n      Object.entries(debounces).forEach(([id, fields]) => {\n        Object.keys(fields).forEach(field => {\n          const [timeout] = debounces[id][field];\n          clearTimeout(timeout);\n          delete debounces[id][field];\n        });\n      });\n    };\n  }, []);\n  const runPendingEditCellValueMutation = React.useCallback((id, field) => {\n    if (!debounceMap.current[id]) {\n      return;\n    }\n\n    if (!field) {\n      Object.keys(debounceMap.current[id]).forEach(debouncedField => {\n        const [, runCallback] = debounceMap.current[id][debouncedField];\n        runCallback();\n      });\n    } else if (debounceMap.current[id][field]) {\n      const [, runCallback] = debounceMap.current[id][field];\n      runCallback();\n    }\n  }, []);\n  const setEditCellValue = React.useCallback(params => {\n    const {\n      id,\n      field,\n      debounceMs\n    } = params;\n    return new Promise(resolve => {\n      maybeDebounce(id, field, debounceMs, async () => {\n        const setEditCellValueToCall = props.editMode === GridEditModes.Row ? apiRef.current.unstable_setRowEditingEditCellValue : apiRef.current.unstable_setCellEditingEditCellValue; // Check if the cell is in edit mode\n        // By the time this callback runs the user may have cancelled the editing\n\n        if (apiRef.current.getCellMode(id, field) === GridCellModes.Edit) {\n          const result = await setEditCellValueToCall(params);\n          resolve(result);\n        }\n      });\n    });\n  }, [apiRef, props.editMode]);\n  const getRowWithUpdatedValues = React.useCallback((id, field) => {\n    return props.editMode === GridEditModes.Cell ? apiRef.current.unstable_getRowWithUpdatedValuesFromCellEditing(id, field) : apiRef.current.unstable_getRowWithUpdatedValuesFromRowEditing(id);\n  }, [apiRef, props.editMode]);\n  const getEditCellMeta = React.useCallback((id, field) => {\n    const editingState = gridEditRowsStateSelector(apiRef.current.state);\n    return {\n      changeReason: editingState[id][field].changeReason\n    };\n  }, [apiRef]);\n  const editingSharedApi = {\n    isCellEditable,\n    setEditCellValue,\n    unstable_runPendingEditCellValueMutation: runPendingEditCellValueMutation,\n    unstable_getRowWithUpdatedValues: getRowWithUpdatedValues,\n    unstable_getEditCellMeta: getEditCellMeta\n  };\n  useGridApiMethod(apiRef, editingSharedApi, 'EditingApi');\n};"]},"metadata":{},"sourceType":"module"}